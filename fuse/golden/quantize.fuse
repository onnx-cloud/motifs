# Cookbook: Quantize/dequantize pragmas demo
# Ops: QuantizeLinear, DequantizeLinear, Cast (or Opset-appropriate variants)
@fuse 1.2
@opset onnx 19
@domain examples.golden
@meta author = "onnx.cloud"

# Demonstrates @quantize / @dequantize pragmas

@quantize("int8", scale=0.1, zero_point=0)
@dequantize
node q_roundtrip(x: f32[3]) -> f32[3] {
  x
}

@proof node test_q() {
  out = q_roundtrip([1.0, 2.0, 3.0])
  assert out == [1.0, 2.0, 3.0]
}
